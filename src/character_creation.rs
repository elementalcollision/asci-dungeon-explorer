;
}})   sh()
 al.flu termin    
        k)?;
   lor::Blac Cor::Grey,olo, Cto go back"N or Esc nfirm, coter to or Enress Y "Pr_y + 10, tered(centeenxt_cterminal.draw_ te    
   ;ack)?w, Color::Blello", Color::Y adventure? begin yourady to"Are you reter_y + 8, (cencentered.draw_text_   terminalt
     mpproon firmati Draw con    //  
    }
          
    :Black)?;lor:ite, Color::Whe, Conam u16 * 2,  2 + i ascenter_y -_x + 10, centerraw_text(inal.d       term
     x];quipment[id_ee.availablereation_stat&c_) = ame,  (n        lette() {
    eraum.enter()es.indicquipment_ielected_eon_state.saticre&idx) in (i,         for ck)?;
, Color::BlaColor::White:", Equipment4, " - , center_yer_x + 5ext(centaw_tinal.dr      term  uipment
eq  // Draw             
  ::Black)?;
White, Color::, Colorsma)rites.cha.attribuon_state{}", creati"CHA: &format!( 2, center_y + - 10, (center_xtextl.draw_   terminack)?;
     or::Bla::White, Cololor), Ctes.wisdomte.attribustation_: {}", crea"WISat!(er_y, &form10, centr_x - tet(cenaw_texnal.drrmi te       Black)?;
:: Color::White,, Colorigence)ellntibutes.ie.attr_stat, creation("INT: {}"mat!_y - 2, &fornter ce 10,ter_x -ext(cen.draw_talminter
        r::Black)?;Colo, Color::Whitetion), tes.constitu.attribuate creation_st: {}",ormat!("CON, &f + 2r_y cente5,r_x - 2w_text(centeal.dra   termin  
   :Black)?;, Color:ite::Why), Colortes.dexteritibuate.attron_stti", crea("DEX: {}t! &formacenter_y, - 25, ext(center_xraw_t.dinalterm    )?;
    ::Blacke, Colorlor::Whitngth), Cotretributes.sion_state.at creat",!("STR: {} 2, &formater_y -, centnter_x - 25draw_text(ceal.termin?;
        ack), Color::Blte, Color::Whi"ttributes: - 4, "A0, center_yr_x - 3_text(centedrawrminal.     tebutes
   attriw   // Dra
              ack)?;
lor::Bl:White, Coe()), Color:d.nam_backgrounlected_state.se", creation: {}"Backgroundat!(, &formcenter_y - 6x - 30, t(center_.draw_texerminal      tk)?;
  Color::Blaclor::White, ()), Coass.nameted_clate.selecston_creati", ss: {}at!("Cla &former_y - 8, - 30, centt(center_xnal.draw_tex   termi)?;
     olor::Black::White, C, Colore).player_namtatecreation_same: {}", format!("N 10, &y -enter_ - 30, cer_xw_text(centdraminal.terry
        mmar suharacte Draw c        //  
      ;
)?:Blackolor:te, CWhir", Color::our characte "Confirm ynter_y - 13,tered(ceaw_text_cen terminal.dr     ;
  lack)?:Br:Colo, low, Color::Yel"ER CREATION5, "CHARACTenter_y - 1entered(ct_cw_tex.dra    terminalitle
    aw t     // Dr       
   / 2;
 ht eigcenter_y = h    let 
    dth / 2;x = winter_et ce       losition
 r pntece Calculate   //  
     );
       ize(.sinalght) = term heidth,  let (wi     ze
 l sit termina  // Ge       
)?;
       ar(.cle terminal
       enthe scre/ Clear  /    
   erminal| {inal(|t= with_termet _    ltate) {
 ationSre&CharacterCate: eation_stn(crirm_screeconf render_);
}

fn()
    }lusherminal.f
        t
        ::Black)?;y, ColorGre", Color::o go backinue, Esc t conter tos Entres 3, "Pred(height -_centew_textra  terminal.d      structions
in   // Draw 
     
        
        }r::Black)?;:White, Cololor:, Co + 1, descered(desc_ynttext_ceaw_drterminal.         
                     };
    e.",
  nsdefeack and tt a bonuses toinorrovides m Pical amulet.> "A magt::Amulet =lo EquipmentS              
 ense.",efes to dr bonuss minovide ring. Proal=> "A magic::Ring uipmentSlot         Eq     
  ightly.",slck power ses attation. Increarotecand p> "HGloves =tSlot::  Equipmen          ",
    .es defense. Increasilityand mobrotection r par fo"Footwe> ts =tSlot::Boouipmen      Eq         e.",
 efensncreases d In.tectioroad p"He> et =t::HelmSlo Equipment         
      se.",s defencreasey inantlnifiction. Sigr protecdy armor fo"Bor => mot::ArntSlo    Equipme     
       ense.",es defreastection. Incr proA shield fo> "ot::Shield =ntSlipme       Equ      ,
   "stance. difrom aing ttackapon for ad werange=> "A t::Ranged loentSpm   Equi           
  .",wer attack poasesncree combat. Ir closeapon foelee w=> "A melee ntSlot::MEquipme             {
   t match slolet desc =       
                  
or::Black)?;llow, Col:Yeame, Color:desc_y, nd(text_centere.draw_nalrmi  te               
       _y + 5;
_y = centeresc  let d        pment];
  elected_equion_state.sent[creatilable_equipmn_state.avaireatio= &cme, slot)    let (na         
len() {equipment..available_teion_stant < creatpmelected_equie.setion_statcrea   if     on
 escriptient dquipmraw e        // D        
       }
    }
 ;
        Black)?w, Color::lloolor::Ye"→", C 22, y_pos, ter_x -(cenxtw_teinal.dra       term     ent {
    is_curr         if 
   ndicator selection i// Draw                
   
     r::Black)?;lo Co color,lot)),("{:?}", se, format!fix, nam", pre"{}{} ({})at!(form20, y_pos, &x - ext(center__traw.d   terminal  
                    " };
{ "[ ] else ] " }[X { "tedelec_s= if isprefix       let e };
      olor::Whitlse { Cw } er::Yelloent { Colof is_currolor = i     let c       
         pment;
   ted_equite.selecation_stat = i == cres_curren i    let
        (&i);ntainsices.cont_ind_equipmee.selectedreation_stat = c_selectedet is     l      i as u16;
 er_y - 7 + os = cent let y_p     {
       e().enumeratment.iter()_equipe.availablestateation_in crlot)) (i, (name, s      for   nt options
mequipw e      // Dra  
        ack)?;
::Blen, Color, Color::Gren())_indices.leipmentcted_equte.seletaon_s", creatiected: {}/3mat!("Selforer_y - 10, &ntred(centecedraw_text_minal.      ter?;
  k)Blacy, Color::relor::G", Co)ontinueto ct, Enter to selece ms (Spac3 iteo up tt "Selec, y - 11r_ed(cente_text_centernal.drawtermi     s
   ctionn instru selectiouipment  // Draw eq     
   ?;
      lack), Color::Blor::White Coequipment",g your startin, "Choose _y - 13nterntered(ceraw_text_ceerminal.d    tk)?;
    r::BlacYellow, Colo Color::REATION",CHARACTER C" 15, nter_y -ered(ceentaw_text_cterminal.dr       
 itle t/ Draw       /    
    
 t / 2; = heighenter_yt c    le2;
    idth / nter_x = wlet ce    ition
    center posCalculate       //    
  ;
     ()nal.sizetermieight) = h, hidt(w let        ize
 terminal s    // Get
    ;
        lear()?minal.cer        t
 the screen Clear   // {
     |terminal|_terminal( = with  let _
  nState) {reatioaracterCChstate: &creation_screen(uipment_n render_eq
}

f
    });lush()erminal.f    t    
      
  r::Black)?; Color::Grey,text, Coloruction_, instheight - 3t_centered(draw_texterminal.         };
  
     " go back) (Esc toinuinge conteforts bte all poin    "Alloca  e {
       els     }"
   o go backtinue, Esc to coner t "Press Ent         = 0 {
  _points =es.unspentttribut_state.acreationt = if ion_texlet instruct    
    ructionsraw inst     // D      
     }
   },
      
           ack)?;or::Blhite, Col", Color::Win magiccertaand ership, tions, leadcial interac"Affects so,  + 1ed(desc_y_text_centerawminal.dr         ter
       ;or::Black)?, Colllowlor::Yea", Coharism"C_y, entered(descxt_c.draw_te terminal               risma => {
e::ChatributeTyp       At
     ,    };
        ::Black)?te, Color:Whi", Color:ine magicand div intuition, ion,pt percets+ 1, "Affeced(desc_y t_centerexdraw_tterminal.        ;
        or::Black)? Colw,lo, Color::Yelm""Wisdoc_y, ed(destext_centerrminal.draw_  te             dom => {
 pe::WisAttributeTy            },
            lack)?;
lor::Be, Co Color::Whitolving", sand puzzleity,  abilarningll power, leects spe, "Aff_y + 1d(desc_centereraw_textinal.d       term      ;
   ack)?Color::Blow,  Color::Yelllligence","Intedesc_y, red(ext_centeaw_t terminal.dr           {
     lligence =>ntebuteType::I Attri    
         },       
   ck)?;lor::Bla:White, CoColor:son", oince to pesistana, and r, stamialth pointscts he 1, "Affe_y +ntered(descw_text_cenal.dra       termi
         lack)?;lor::Blow, Color::Yeln", CoConstitutiodesc_y, "xt_centered(al.draw_temin ter               {
 stitution =>Type::ConAttribute         ,
            }  Black)?;
 olor::::White, C Colorflexes",nd re alth,nse, steacuracy, defe"Affects acesc_y + 1, _centered(dl.draw_textrmina   te            
 )?;Color::Black, owColor::Yell", rityteDex "y,ntered(desc_w_text_cerminal.dra te             y => {
  eriteType::Dextut      Attrib
            },k)?;
      or::Blachite, Colr::Wks", Colotasal sicand phy capacity, nge, carryiee damagts melffec"Ac_y + 1, d(desext_centerel.draw_tnatermi          k)?;
       Color::Blacow,::Yell Colorh", "Strengtc_y,red(descentew_text_terminal.dra           => {
     rength pe::StibuteTytr  At       ibute {
   cted_attr.selen_statetch creatio ma 5;
        +center_y= _y    let descons
     e descriptiw attribut// Dra      
   }
            }
         k)?;
      lor::Blacw, Co::Yello, Color→"2, y_pos, "r_x - 2cente_text(rminal.draw        te     
   {e uttribected_atte.sel_sta creationype == if *attr_t        
   ndicatorection i // Draw sel                 
    ;
  r::Black)?lor, Colo_str), cofiere, modi})", valu} ({rmat!("{ y_pos, &fox + 5,(center_al.draw_texttermin  
          ck)?;olor::Bla Cr,me, colos, na0, y_por_x - 2xt(centedraw_te  terminal.                
     fier) };
 {}", modiormat!("lse { fdifier) } emo!("+{}", { formatifier >= 0 od= if mr_str difielet mo            tr_type);
modifier(*atutes.get_tribn_state.atr = creatioodifie   let m         ier
ulate modif  // Calc
                   
   };lor::White se { Coellow } el::Y Colorte {ted_attribuecstate.sel== creation_*attr_type  if color =        let   6 * 2;
   + i as u1y - 7 center_ y_pos =        lette() {
    enumera.iter(). attributes inlue))vame,  nar_type,(att for (i,       
        
   ];
      ,charisma)utes.tate.attribreation_sisma", c, "Charismae::CharttributeTyp  (A          m),
utes.wisdoattribate.ion_stcreat", m, "WisdomWisdobuteType::ri  (Att          gence),
utes.intellittribn_state.a", creatioligence, "IntelligenceeType::Intelttribut    (A),
        tion.constitubuteste.attriation_stan", cre"Constitutio nstitution,::CoeTypebut      (Attri   
   rity),dexteutes..attribeation_state crity",Dexter "Dexterity,eType::ttribut        (A
    .strength),.attributestatetion_s creaength",th, "Strype::StrengibuteT   (Attr       = [
  ttributes  a
        letttributes   // Draw a  
     
      k)?;ac::Bl:Grey, Color", Color:stto adjuight e, left/rgat to navis or hjklrow key0, "Use arnter_y - 1tered(cew_text_cenminal.dra     ter  ack)?;
 ::Blor Colr::Green,ts), Colounspent_poinbutes.e.attritattion_srea", c}t Points: {at!("Unspen&formr_y - 11, tered(cente_text_ceninal.drawerm
        tructionsnstion ie allocatraw attribut// D
               lack)?;
 :B Color:White,s", Color::ur attributee yo "Allocatr_y - 13,tered(centeraw_text_cen terminal.d       ack)?;
or::Bllow, Color::Yel ColN",R CREATIO "CHARACTEy - 15,ed(center_nter_cextal.draw_te    termintle
    / Draw ti
        /
         / 2;y = height let center_     
  ;h / 2x = widtter_t cen
        leonpositier late cent    // Calcu  
          ize();
erminal.sight) = t (width, helet
        nal sizermi   // Get te    
        
 .clear()?;erminal t      creen
 he s t Clear//       inal| {
 al(|term with_termin_ =
    let tate) {onSeatiCharacterCrtate: &reation_sn(ctes_screeattribu
fn render_ });
}
flush()
     terminal.   
      ;
     ck)?r::Bla Color::Grey, Coloack",to go be, Esc  continus Enter to- 3, "Presered(height ext_centaw_terminal.dr       t
 uctions instrDraw  //     
      
    ck)?;lor::Bla, Coen, Color::Gre_attr)onus+1)", bs: {:?} ( Bonuibute!("Attrormatsc_y + 4, &ftered(dew_text_cenerminal.dra;
        tus()_bond.attributeackgroune.selected_beation_status_attr = crt bon        leonus
bute b/ Draw attri
        /   
     ack)?;r::Bllo Co::White,, Coloription()d.descrrounckgbaselected_te.n_sta creatioesc_y + 2,red(dntew_text_cel.drarmina  te      :Black)?;
llow, Color: Color::Yeion:",d Descript"Backgrounesc_y, tered(den_text_cminal.draw     ter 2;
   ter_y + = cen let desc_y  n
     d descriptiow backgroun Dra
        //        }
   k)?;
     Color::Blac), color, ", key, desc{}mat!("{} - &fory_pos, - 30, enter_x w_text(cl.dranatermi        e };
    Color::Whit} else { :Yellow Color:ground { _backte.selectedation_sta= creg_type =olor = if *b      let c     * 2;
   as u16 i +y - 10os = center__plet y          () {
  .enumerate.iter()kgrounds in bac desc))ype, key,g_tor (i, (b 
        f
        ];       wledge"),
orldly knoand w, gotiation, nengt - Tradierchan, "M"6":Merchant, e:oundTyp  (Backgr         ),
 ervice"divine sd aining anus treligiote - R"Acolyte, "5", Acolye::groundTyp   (Back   "),
      etyd soci law anide thefe outs"Outlaw - Liw, "4", utlae::OroundTypckg     (Ba    ),
   "educationnd nging ad upbririvilege P", "Noble -e, "3pe::NoblndTy  (Backgrou          es"),
cane studige and armic knowledde- Acacholar "2", "SScholar, ndType::ou    (Backgr    "),
    isciplinend dy training ar - Militaroldie"S, "1", iere::SoldoundTyp (Backgr      s = [
     oundlet backgrs
        ound optionackgraw b       // Dr
 
        k)?;lor::Blacite, Coor::Whold", Cr backgroun"Choose you - 13, nter_yed(cetext_centerinal.draw_   termck)?;
      Color::Blaw,:Yello", Color:REATION"CHARACTER C - 15, nter_y(cet_centerednal.draw_tex       termi
 tleDraw ti   //  
          t / 2;
  y = heighnter_t ce  le    th / 2;
  nter_x = wid      let cetion
  posicenter e atalcul // C     
    ;
      al.size()= terminheight) dth, (wilet        al size
 Get termin //  
       
       )?;clear(l.termina
        reenear the sc// Cl        inal| {
l(|termth_termina let _ = wite) {
   CreationSta &Charactere:ation_stat_screen(crendckgroun render_ba

f
});   }sh()
 nal.flu  termi    
      ck)?;
    ::Bla:Grey, Colorlor:k", Co to go bacnue, Escconti to ss Enter, "Pre 3ht -red(heigw_text_centel.drarmina      teions
  raw instruct  // D    
      ;
    r::Black)?en, ColoGre, Color::ndary)1)", secoe: {:?} (+utttribSecondary A!("ormatsc_y + 5, &fed(de_center.draw_textrminal te   k)?;
    ac:Blreen, Color::Gr:, Colo", primary)2):?} (+tribute: {ry Atmat!("Prima+ 4, &for_y (descext_centeredw_traerminal.d      t  
        e();
attributdary_lass.seconlected_cte.seeation_staary = crt second     le   ibute();
attrrimary__class.p.selectedtecreation_staprimary = et     ls
    teattribuy arnd secondw primary a // Dra   
         
   )?;lor::Black, CoColor::Whiten(), descriptioted_class.te.selecon_stareatiesc_y + 2, ctered(d_cenraw_text  terminal.d
      k)?;Color::Blacow, or::Yell Colription:",Descs _y, "Clasentered(descaw_text_cerminal.dr t 2;
       y +nter_desc_y = ceet        lription
 descass // Draw cl   
            }
         )?;
lack, Color::B), colordesc}", key, t!("{} - {rmafoy_pos, &- 30, r_x ext(cente_tal.draw   termin      };
   White r::e { Cololslow } eolor::Yel { Cted_class.seleceation_statepe == crif *class_tycolor =     let 2;
         i as u16 *  +ter_y - 10s = cen  let y_po
          umerate() {.iter().enesc)) in classey, des, kpety(i, (class_        for 
        
    ];    dom"),
wisand xterity gh dehier with untA skilled hnger - ", "Ra"5::Ranger, ype(ClassT            om"),
igh wisdith hter wine spellcasdivric - A  "Cle","4eric, Type::Cl      (Class,
      ence")intelligh high llcaster witerful spe- A powge "3", "Mae::Mage, (ClassTyp       ,
     rity")h high dextewitef e thinimblue - A "Rog"2", e, pe::Rogu(ClassTy         "),
   nstitutiond co strength anh highor witkilled warri A s"Fighter -1", ghter, "Fiype::    (ClassT      
  s = [sselet cla
        ptionsaw class o      // Dr
         ?;
 ck), Color::Blate Color::Whiss",our claChoose y13, "ter_y - ed(cenxt_center.draw_teterminal     
   :Black)?;olor:llow, C:Yeolor: CEATION",TER CR"CHARACer_y - 15, tered(cent_cendraw_textterminal.
        titleaw     // Dr          
  eight / 2;
center_y = h   let ;
     h / 2r_x = widtet cente     losition
   er pcentlate alcu // C  
           ize();
  terminal.sight) =  (width, he letize
       nal s termi // Get  
       )?;
      al.clear(termin         screen
r the     // Cleal| {
   minarminal(|ter = with_telet _
    nState) {reatio &CharacterCstate:tion_n(creaclass_screeender_fn r
}

  });  sh()
minal.flu    ter         
 ck)?;
  or::BlaGrey, Colr::", Coloto main menuurn  retue, Esc toin conttoess Enter _y + 5, "Prnter_centered(cew_textterminal.dra      ctions
  stru// Draw in        
        
 )?;ck
       Color::Bla         
   lor::White,      Co_',
        '       s u16,
   r_y - 2) ante      (ce,
      16n()) as uleme._na.playern_state + creatio - 13er_xcent    (        ar_at(
_cherminal.draw
        tursor// Draw c        
?;
        ack)lor::Blhite, Cor::Wname, Color_playete._staon2, &creatier_y - ent_x - 13, cxt(centerdraw_tenal.       termick)?;
 ::Blalor, Coolor::White, C, 30, 3_y - 3enter, cx - 15_box(center_l.drawna  termiox
      ame input bw n   // Dra  
     
      ?;r::Black)te, Coloor::Whiol C's name:",racterhaur cter yo 5, "Encenter_y -ed(centerw_text_al.dra      terminprompt
  aw name     // Dr
        )?;
    Color::Black, r::YellowION", ColoEATHARACTER CR "C_y - 10,enter_centered(cext.draw_trminal    teitle
     Draw t       //    
  / 2;
    hty = heigcenter_et      l;
    / 2thter_x = wid let cen  on
     ositicenter p Calculate       //
  
        ();al.sizemint) = terighidth, he let (w   l size
    Get termina //        
      )?;
  l.clear(inaerm   t     n
eear the scr Cle     //inal| {
   inal(|term= with_termet _ {
    lnState) Creatioeraract: &Chtion_stateeareen(crnder_name_sc

fn re
    }
}   _ => {}),
     ion_state(creatfirm_screenr_con> renderm =ficterCon:CharanState:      Rustate),
  n(creation_eecrequipment_s render_uipment =>racterEqe::Cha     RunStat   n_state),
creatioeen(_scrr_attributesendes => rAttributeharacterunState::C,
        Rstate)en(creation_nd_screckgrouder_bad => renrBackgroun:CharacteunState:      Rte),
  ation_stacrescreen(s_ender_clasrClass => rteace::Char   RunStat
     te),station_reaame_screen(cder_ne => renCharacterNam  RunState:: {
      e.run_statetatgame_sh     matcnState) {
reatiocterCChara_state: &te, creationeStaGamtate: &(game_ster_creationcharac render_
}

pub fn,
    }> false_ =,
           }    true
           ent;
  racterEquipmate::Cha RunState =ste.run_me_stat    ga {
        :Esc =>| KeyCode:'n') e::Char(     KeyCod         },
  true
          
  n;State::PreRue = Rune.run_state_stat    gam   er);
      Some(playyer =tate.plagame_s       y);
     , player_ayer_x.world, plame_statet gyer(&mulacreate_ption_state. = creat player     le5;
        = 2r_yaye     let pl
       40;er_x =   let play
           the game and startplayerreate the     // C         => {
ntere::E | KeyCod('y')::Char  KeyCodede {
      t.coch key_even
    matool {nState) -> breatioterCt Characn_state: &muioatte, creStamut Gametate: &t, game_sven: KeyEt(key_eventirm_inpule_conffn hand    }
}

e,
   _ => fals   },
     true
                 ttributes;
cterAtate::CharanS_state = Ru.run game_state        sc => {
   eyCode::E    K
         },   true
        irm;
    rConfharactenState::Cate = Rutate.run_stame_s         g
   :Enter => {  KeyCode: },
      ue
              tr  }
     
          );(idxpushs.ent_indiceipmed_equtate.select_seation         cr
        itemsg equipment3 startinLimit to    //              {
 n() < 3_indices.leipmentlected_equstate.sen_f creatio i     } else  
      idx);n(|&i| i !=etait_indices.red_equipmenate.selecttion_st      crea     dx) {
     ins(&icontaent_indices.d_equipmctelete.seon_sta if creati
           pment;equilected__state.sex = creation let id       tion
    oggle selec T//  
           => {(' ')de::CharyCo Ke },
            ue
     tr
         t.len();ble_equipmenla_state.avaiionat cre1) % + d_equipmentectee.selreation_stat= (cpment _equi.selectedn_statecreatio            wn
selection doe  // Mov     => {
      ('j') ::CharCode | Keye::Down KeyCod },
       
          true    
      }     1;
      en() - ipment.lble_equ.availaation_statement = cred_equipte.selectestation_ crea              else {
             }t -= 1;
 equipmend_cte.seleon_statecreati              {
   pment > 0quid_etelecn_state.se  if creatio      p
    n ulectio/ Move se    / {
        r('k') =>::ChayCode KeyCode::Up |    Ke
    e {nt.codh key_eve
    matcol {) -> boreationStateerCt Charact&mution_state: eameState, crGastate: &mut game_eyEvent, ent: Ky_evt_input(kemene_equip
fn handl

}se,
    }   _ => fal         },
 true
         
      kground;erBac::CharactRunStatete = e.run_statatme_s          ga  );
tes::new( Attribuributes =tttion_state.aea         cr   go back
 andtributes / Reset at          / {
  ode::Esc =>yC        Ke
},      true
              
       }t;
     cterEquipmene::Chara = RunStatrun_stategame_state.             
   {== 0 ints s.unspent_poattributeon_state.ati     if cre   {
     r =>Code::EnteKey          },
 rue
         t   te);
     ed_attribuctsele_state.te(creatione_attribus.increase.attributetion_stat  crea
          ributeelected attse s Increa        //> {
    ('l') =de::Charght | KeyCo KeyCode::Ri},
               true
      ;
      d_attribute)selectee.ion_statte(creatase_attribuecrettributes.dtate.an_s creatio        ute
   d attribctee selecreas/ De          /') => {
  ('hChar | KeyCode:::Leftode:eyC     K     },
   ue
    tr      
     };          th,
  ngtreuteType::S> Attribarisma =e::ChbuteTyptri   At            harisma,
 buteType::Com => Attri:WisdeType: Attribut            sdom,
   buteType::WiAttrince => :IntelligeributeType:  Att            
  ence,:Intellige:AttributeTypution => pe::Constit AttributeTy            
   ution,::ConstitpeeTyAttributexterity => ype::D AttributeT               erity,
extpe::DeTy Attribut =>thtrengype::SributeT        Att      te {
  tribued_atstate.selectation_match creute = ribed_atttate.selection_screat            down
 ionlect  // Move se
          'j') => {yCode::Char(own | Ke KeyCode::D
               },    true
        };
       dom,
     uteType::Wisrib => Attmais::ChareTypettribut       A    ence,
     lligteType::Inte> Attribum =sdobuteType::WiAttri               itution,
 eType::Const=> Attributnce gelieType::IntelAttribut           ty,
     DexteriibuteType::ttrtution => Ati:ConstributeType: At            
   Strength,uteType::y => Attribe::DexteriteTypAttribut           sma,
     ripe::ChauteTyrib> Attrength =pe::SteTybuttriAt             {
    bute_attriectedselon_state.match creatitribute = lected_ation_state.se   creat         ction up
ve sele     // Mo     k') => {
  har(' KeyCode::C::Up |Code      Keyt.code {
  h key_even {
    matcboole) -> ionStatreatacterC: &mut Chartion_statee, crea GameStat: &muttegame_stavent, event: KeyEput(key__in_attributesandle}

fn he,
    }
 => fals
        _   },true
           ss;
      haracterClate::Ctatate = RunState.run_sme_s          ga => {
  :Esc    KeyCode:   
 
        },true   ;
         tesriburacterAttte::ChaunStatate = Re.run_same_stat          gses();
  nuround_boply_backgn_state.apio       creat
     _bonuses();ssy_clatate.applon_seati   cr        s
 ributeto attre moving s befouseonground bbackss and pply cla      // A     {
 Enter => ode::       KeyC    },
 rue
         t;
       pe::MerchantBackgroundTyund = ackgrolected_bn_state.sereatio          c{
  har('m') => yCode::C | Kehar('6')KeyCode::C,
         }    
       true;
        ::AcolyteckgroundTypeBa = backgroundd_selecteon_state.ati  cre          => {
 ar('a')Code::Ch'5') | Keyhar(yCode::C
        Ke       },    true
       Outlaw;
  ::oundTypend = Backgrbackgrouselected_te.eation_sta     cr     > {
  Char('o') =de::yCoKe'4') | r(e::ChaCod    Key},
             true
          ::Noble;
 ckgroundType Ba =d_backgroundselectee.ation_stat       cre> {
     ') =Char('nde::) | KeyCoChar('3'eyCode::        K    },
rue
      t
          holar;oundType::Scckgr Baround =ected_backgate.selst  creation_
          ar('c') => {KeyCode::Char('2') | ::Ch KeyCode       },
   rue
           t
      oldier;Type::Sround = Backggroundbackselected_ate.n_streatio         c> {
   s') =ode::Char(' | KeyC1'):Char('Code: Key      {
 .code y_event  match keol {
  ate) -> boerCreationStt Charactstate: &mueation_te, crGameStae: &mut  game_statEvent,Key_event: t(keyund_inpundle_backgron ha   }
}

fse,
  _ => fal},
       
                truerName;
    teate::CharacRunSt= .run_state tate      game_s
      ::Esc => {ode   KeyC      },
e
          tru
         kground;terBac:Charace:nStatte = Rustan_.rutegame_sta           
  => {de::Enter      KeyCo  },
  rue
              t    
:Ranger;Type:= Class_class electedn_state.seatio      cr=> {
      har('a')  KeyCode::C') |ar('5KeyCode::Ch       },
   rue
            tc;
      :Cleri= ClassType:_class ectedstate.seln_eatio    cr
        ) => {('c'ode::ChareyCar('4') | KKeyCode::Ch    },
     e
          tru        ::Mage;
 ssTypeClated_class = e.selecion_stat      creat     {
 har('m') => | KeyCode::C::Char('3') KeyCode,
             }e
       tru;
        ueRoglassType::_class = Cte.selectedreation_sta   c         ('r') => {
har:C| KeyCode:har('2') de::CyCo       Ke      },
 rue
          tghter;
    assType::Fid_class = Clcten_state.sele   creatio         ('f') => {
ode::Char1') | KeyChar('eyCode::C      Kcode {
  y_event.ch kematol {
    e) -> boionStataracterCreate: &mut Cheation_statmeState, crt Gaate: &munt, game_stveevent: KeyE_input(key_lasshandle_cn  }
}

f   false,
 _ =>              },
   true
      ;
     :MainMenuate:ate = RunStsttate.run_      game_s=> {
      ::Esc de  KeyCo  },
                  true
}
                 lass;
 acterCte::CharRunSta= te e.run_stagame_stat     
           empty() {s_name.iyer_e.plation_stat   if !crea{
         er => eyCode::Ent       K
        },   true
     
     name.pop();layer_te.pon_staati cre
           {e => Backspac KeyCode::
         },     e
   tru     }
               ush(c);
  ame.payer_nn_state.pltio crea             {
  n() < 20 er_name.lete.playreation_sta c         if   r(c) => {
ha::CCode      Key
  de {nt.cokey_eve
    match ool { b->e) CreationStatharactere: &mut Creation_statate, cSt &mut Gamegame_state:, : KeyEventnty_evenput(kendle_name_i
}

fn hae,
    }_ => fals    ,
    tion_state)creagame_state, ey_event, ut(kirm_inpnfcoe_rm => handlracterConfiState::Cha       Run
 te),_state, creation game_stakey_event,t_input(menandle_equip> hEquipment =eractState::Char Run
       n_state),reatiostate, cevent, game_key__input(butestri> handle_at =tesriburacterAttunState::Cha      R
  te),taation_ste, creme_sta_event, gad_input(keybackgroun handle_round =>Backgacter:Chartate:  RunS),
      n_statecreatio, ame_statey_event, gket(ass_inpudle_cls => hanrClastearacnState::Ch
        Rutate),n_satiostate, crevent, game_nput(key_edle_name_ie => hanrNamte:Charactate:      RunS_state {
  e_state.run  match gam {
   -> booltionState)reaaracterCte: &mut Chon_staatitate, cremut GameS: &, game_stateKeyEventy_event: ut(keinpion_er_creatdle_characthanpub fn }

    }
m
ite  
        }
           
   em"); to equip itedilect("Fa.expslot }){ owner, uipped Eqnsert(item,   equipped.i         
 uipped>();orage::<Eqite_std = world.wrequippemut   let 
                 {    
  }
                  }
m);
     h(itepusms.te.i      inv      
    wner) {mut(oentory.get_invv) =  Some(in  if let    >();
      ::<Inventorye_storagerld.writ= woventory inmut et          l  {
          
   ();
    uildilder.bm = item_but ite        le it
d equipentory ano invdd t/ A   /
               }
);
       }_bonuse: defensedefensus { eBon(Defenser.withem_build= itlder em_bui  it           > 0 {
se_bonusf defen
        i    }
    );
         }usr_bonwer: powe { poBonusower.with(MeleePem_builderbuilder = it   item_         onus > 0 {
f power_b
        i
        lot });e { squippablh(Eit    .w    )
              }r: 2,
   render_orde              Black,
 r::olobg: C          n,
       Color::Cyag:   f            ,
   glyph         
     erable {ndith(Re   .w    })
     ring() e.to_stname: namh(Name {  .wit   
        })Item {     .with(       y()
ntitte_eorld.crea = witem_builderlet mut   
        
      
        };et => '"',:Amult:ipmentSlo     Equ
       '=',g => t::RinquipmentSlo    E      ,
   => 'g'Slot::GlovesEquipment     b',
        => 'BootsSlot::ipment         Equ'^',
   :Helmet => ipmentSlot:Equ             => '[',
:ArmormentSlot:quip      E    
   => '(',::ShieldentSlot  Equipm         '}',
 ed => tSlot::Rangquipmen     E',
       e => '/tSlot::Mele    Equipmen  
      match slot {ph =    let gly
          
   };    , 1),
    > (1et =t::AmulquipmentSlo       E1),
     g => (0, lot::RinquipmentS    E,
        , 0)(1ves => GlotSlot::quipmen           E1),
 ts => (0, Boo::entSlotEquipm           
  1),elmet => (0,pmentSlot::H   Equi
         , 3),or => (0ot::ArmmentSl      Equip2),
      > (0, hield =tSlot::S   Equipmen          (1, 0),
ed =>nglot::RaipmentS       Equ
     ,=> (2, 0)ot::Melee uipmentSl     Eq
       atch slot {= mse_bonus) defenower_bonus,  (p
        letsed on typees bate bonusth appropriaquipment wi // Create e {
       -> Entityt) pmentSloot: Equi, sl: &str, nametityner: End, ow Worl &mutelf, world:equipment(&sn create_  f    
     }
  player
      
       );
  layer_name).p...", selfe beginsenturdvr a}! Youcome, {"Welformat!(ntry( log.add_e   >();
    e::<GameLog_resourc world.writeut log =     let me
    messagdd a welcome     // A     
      }
       t);
 ame, *sloyer, norld, plaequipment(weate_  self.cr      idx];
    ent_quipmnt[ee_equipmelabl= &self.avai slot) t (name,      le      ices {
ipment_inded_equ&self.selectidx in pment_or &equi       fentory
 ment to invlected equip   // Add se    
        
 d();       .buil     und })
rocted_backge: self.seleground_typback { ckground    .with(Ba        })
 d_classelecte self.ss_type:classs { cterClaith(Chara.w    
        clone())tes.lf.attribuseh(     .wit      :new())
 erience:   .with(Exp         26))
new((Inventory::.with        w())
    erInput::ne.with(Play    })
              th),
      e::StrengibuteTyper(Attrodifies.get_mlf.attribut+ se 5       power:         
 Dexterity),pe::Tyr(Attributedifie_moes.get.attribut selfe: 2 +efens    d          .max(1),
    hp: max_hp           1
     is at least/ Ensure HPmax(1), /hp.: max_   max_hp        
     atStats {th(Comb .wi         })
         
     .clone(),player_nameself.    name:        {
     ith(Name   .w               })

        true,y:    dirt      : 8,
       range               ,
ec::new()s: Ve_tile visibl          {
      ewshedith(Vi          .wer {})
  ay  .with(Pl           })
          order: 0,
     render_   
         :Black,r:: Colo  bg         
     hite,: Color::W     fg         @',
   glyph: '           {
     nderable  .with(Re        y })
   sition { x,(Powith      .y()
      ate_entitorld.cre= w let player        ponents
ith all comr entity wthe playeate      // Cre      
   fier;
  odihp + con_mbase_= max_hp   let     p();
  _htingss.stared_claelf.select_hp = set base    l);
    stitution::ConpeAttributeTyt_modifier(ibutes.ge.attr = selfon_modifierlet c
        ierodiftitution mconss and sed on clase HP ba Calculat    //ty {
     Enti) ->32i32, y: irld, x: d: &mut Wo&self, worler(reate_playfn cub  
    p
    }
        } 1,
   arisma +=es.chibut.attr> self =:CharismabuteType:    Attri,
        dom += 1utes.wisself.attribWisdom => uteType::   Attrib   1,
       +=ligence telinattributes.nce => self.elligeteType::Int    Attribu  1,
      n += nstitutiotes.coattribuf. sel =>onutititpe::ConsibuteTy Attr         ty += 1,
  rites.dexteattribuelf.ity => sType::Dexterbute     Attri     
  ngth += 1,trebutes.sattrilf.h => se::StrengtbuteType       Attri
      {us()ibute_bonkground.attrted_bacleclf.setch se        maattribute
d rounto backgy +1      // Appllf) {
   &mut sed_bonuses(unackgrofn apply_b  pub    
     }
 
   },
      sma += 1aributes.chlf.attri> sema =Type::Charisute     Attrib1,
       .wisdom += attributesself.om => sdWi::ypeibuteTttr   A        += 1,
  igenceutes.intellattribelf.gence => spe::IntelliuteTytrib        At
    ution += 1,s.constitibuteattr> self. =nstitutionType::Coibutettr        A,
    += 1ity es.dexterelf.attributy => sDexteritpe::ttributeTy A           1,
ength += tributes.strf.atelgth => stren::SttributeType   A
         bute() {y_attriecondars.slected_claself.se s   match        
          }
  a += 2,
 rismributes.chatt self.arisma =>Chae::ypributeT        Att,
    sdom += 2tes.wiributtf.a> selsdom =Type::Wi  Attribute          e += 2,
ligencelributes.intf.attgence => sel::IntelliypeteT  Attribu       ,
   ution += 2utes.constitattribn => self.ConstitutioibuteType::  Attr          y += 2,
eritbutes.dextrittty => self.ariDexteeType::ttribut     A
       = 2,th +s.strengttributelf.a> se:Strength =uteType:      Attrib() {
      ttributess.primary_a_claedf.selectel smatch
        butendary attri1 to secoe and +tributimary at prpply +2 to    // A   t self) {
 bonuses(&muly_class_ub fn app
    p }
          }
   ),
  Vec::new(: cesindiipment_lected_equse              ],
   
       mulet),:Alot:, EquipmentSg().to_strinealth" of Hulet     ("Am           t::Ring),
tSlo), Equipmentring(o_s".ttionrotecf P("Ring o                
oves),Slot::Gl, Equipmentring()sto_s".tove("Gl                Boots),
tSlot::menEquiping(), _strots".to  ("Bo     ,
         Helmet)pmentSlot::Equitring(), to_s". ("Helmet           r),
    t::ArmouipmentSlong(), Eq".to_strither ArmorLea     ("           ld),
lot::Shie EquipmentSg(),d".to_strin  ("Shiel      ,
        Ranged)::uipmentSlottring(), Eqow".to_s"B         (
       ::Melee),ipmentSlotng(), EqustriSword".to_       ("        : vec![
 ntequipmelable_        avai
    pment: 0,cted_equile        segth,
    eType::Strene: Attributibuttratected_     sel   ,
    tes::new()s: Attribu attribute         Soldier,
  undType::ackground: Bd_backgroelecte       s
     hter,ssType::Figclass: Claselected_       
     ,::new()e: Stringr_nam playe         {
  e nStateatioCrcterra    ChaSelf {
    ) -> w(pub fn nete {
    ationStaterCre Charac}

impl
ize>,es: Vec<usdicpment_ind_equiselecte   pub 
 ot)>,quipmentSl E(String,ment: Vec<ble_equipb availae,
    pusizquipment: ud_e pub selecte   e,
ibuteTyp: Attruteattribted_ub selec   ps,
 ibute: Attrtributesb at    pundType,
ackgrouackground: Bb selected_be,
    puypassTlass: Cled_cb selecting,
    pur_name: Strlaye p  pub
  te {CreationStaCharacterpub struct ;

GameLogsources:::ree:e cratnal;
us:with_termiinal:ering::term crate::rend;
useeState}nState, Gam::{Ru_stateamee::grat
use conents::*;ompate::ce cr

usle::Color;term::styrosse cCode};
useyEvent, Keyvent::{Kerm::ese crosst
uBuilder};y, xt, EntitorldE, W{Worldpecs::use s